<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¤§å‹å®¶å…·å›æ”¶é ç´„å¹³å° - è³‡æ–™åº«è¨­è¨ˆ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
    }
    h1, h2 {
      color: #2C3E50;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      margin-bottom: 20px;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background-color: #34495E;
      color: #fff;
    }
    .description {
      background-color: #f9f9f9;
      padding: 15px;
      margin-top: 10px;
      border: 1px solid #ccc;
    }
    .toggle-buttons {
      margin-bottom: 20px;
    }
    button {
      padding: 8px 16px;
      margin-right: 10px;
      font-size: 14px;
    }
    #table-view, #mermaid-view {
      display: none;
    }
    #table-view.active, #mermaid-view.active {
      display: block;
    }
    pre {
      background: #f9f9f9;
      padding: 20px;
      border: 1px solid #ddd;
      overflow-x: auto;
    }
    a{
        color: #2980B9;
        font-weight: bold;
    }
    a:hover{
        text-decoration: underline;
    }
    a:visited{
        color: #2980B9;
    }
  </style>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: false });
    window.renderMermaid = () => {
      mermaid.run({ nodes: [document.querySelector("#mermaid-graph")] });
    };
  </script>
</head>
<body>
<h1>å¤§å‹å®¶å…·å›æ”¶é ç´„å¹³å° - è³‡æ–™åº«è¨­è¨ˆ</h1>
<div class="toggle-buttons">
  <button onclick="showView('table')">ğŸ“‹ è³‡æ–™è¡¨æª¢è¦–</button>
  <button onclick="showView('mermaid')">ğŸ“Š ERD æµç¨‹åœ–</button>
  <a href="easy_er.html" target="_blank">ç°¡æ˜“çš„æµç¨‹åœ–</a>
  <a href="complicated_er.html" target="_blank">æ–°çš„ERDæµç¨‹åœ–</a>
</div>
<div id="table-view" class="active">
<!-- Users Table -->
<h2>1. `users` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>åƒæ•¸å‹æ…‹</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>id</td>
    <td>INT</td>
    <td>ä¸»éµï¼Œè‡ªå¢</td>
  </tr>
  <tr>
    <td>username</td>
    <td>VARCHAR(255)</td>
    <td>ä½¿ç”¨è€…åç¨±ï¼Œå”¯ä¸€</td>
  </tr>
  <tr>
    <td>password</td>
    <td>VARCHAR(255)</td>
    <td>ä½¿ç”¨è€…å¯†ç¢¼</td>
  </tr>
  <tr>
    <td>email</td>
    <td>VARCHAR(255)</td>
    <td>ä½¿ç”¨è€…é›»å­éƒµä»¶</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>TIMESTAMP</td>
    <td>è¨»å†Šæ™‚é–“</td>
  </tr>
  <tr>
    <td>updated_at</td>
    <td>TIMESTAMP</td>
    <td>æœ€å¾Œæ›´æ–°æ™‚é–“</td>
  </tr>
  <tr>
    <td>is_manager</td>
    <td>BOOLEAN</td>
    <td>æ˜¯å¦ç‚ºå¾Œå°ç®¡ç†å“¡</td>
  </tr>
  </tbody>
</table>

<!-- Furniture Requests Table -->
<h2>2. `furniture_requests` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>åƒæ•¸å‹æ…‹</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>id</td>
    <td>INT</td>
    <td>ä¸»éµï¼Œè‡ªå¢</td>
  </tr>
  <tr>
    <td>name</td>
    <td>VARCHAR(255)</td>
    <td>å®¶å…·åç¨±</td>
  </tr>
  <tr>
    <td>type</td>
    <td>VARCHAR(100)</td>
    <td>å®¶å…·é¡å‹</td>
  </tr>
  <tr>
    <td>dimensions</td>
    <td>VARCHAR(100)</td>
    <td>å®¶å…·å°ºå¯¸ (ä¾‹å¦‚ï¼šé•·Ã—å¯¬Ã—é«˜)</td>
  </tr>
  <tr>
    <td>material</td>
    <td>VARCHAR(100)</td>
    <td>å®¶å…·ææ–™</td>
  </tr>
  <tr>
    <td>weight</td>
    <td>DECIMAL(10,2)</td>
    <td>å®¶å…·é‡é‡ (å…¬æ–¤)</td>
  </tr>
  <tr>
    <td>status</td>
    <td>VARCHAR(50)</td>
    <td>å®¶å…·å›æ”¶ç‹€æ…‹</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>TIMESTAMP</td>
    <td>å»ºç«‹æ™‚é–“</td>
  </tr>
  <tr>
    <td>updated_at</td>
    <td>TIMESTAMP</td>
    <td>æœ€å¾Œæ›´æ–°æ™‚é–“</td>
  </tr>
  </tbody>
</table>

<!-- Recycling Points Table -->
<h2>3. `recycling_points` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>åƒæ•¸å‹æ…‹</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>id</td>
    <td>INT</td>
    <td>ä¸»éµï¼Œè‡ªå¢</td>
  </tr>
  <tr>
    <td>name</td>
    <td>VARCHAR(255)</td>
    <td>å›æ”¶é»åç¨±</td>
  </tr>
  <tr>
    <td>address</td>
    <td>VARCHAR(255)</td>
    <td>åœ°å€</td>
  </tr>
  <tr>
    <td>latitude</td>
    <td>DECIMAL(9,6)</td>
    <td>ç¶“åº¦</td>
  </tr>
  <tr>
    <td>longitude</td>
    <td>DECIMAL(9,6)</td>
    <td>ç·¯åº¦</td>
  </tr>
  <tr>
    <td>available</td>
    <td>BOOLEAN</td>
    <td>æ˜¯å¦å¯ç”¨</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>TIMESTAMP</td>
    <td>å»ºç«‹æ™‚é–“</td>
  </tr>
  <tr>
    <td>updated_at</td>
    <td>TIMESTAMP</td>
    <td>æœ€å¾Œæ›´æ–°æ™‚é–“</td>
  </tr>
  </tbody>
</table>

<!-- Service Slots Table -->
<h2>4. `service_slots` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>åƒæ•¸å‹æ…‹</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>id</td>
    <td>INT</td>
    <td>ä¸»éµï¼Œè‡ªå¢</td>
  </tr>
  <tr>
    <td>user_id</td>
    <td>INT</td>
    <td>å¤–éµï¼ŒæŒ‡å‘ `Users` è¡¨</td>
  </tr>
  <tr>
    <td>recycling_point_id</td>
    <td>INT</td>
    <td>å¤–éµï¼ŒæŒ‡å‘ `Recycling Points` è¡¨</td>
  </tr>
  <tr>
    <td>date</td>
    <td>DATE</td>
    <td>å›æ”¶æ—¥æœŸ</td>
  </tr>
  <tr>
    <td>time_slot</td>
    <td>VARCHAR(50)</td>
    <td>å›æ”¶æ™‚æ®µ</td>
  </tr>
  <tr>
    <td>furniture_list</td>
    <td>TEXT</td>
    <td>å®¶å…·æ¸…å–® (JSON æ ¼å¼)</td>
  </tr>
  <tr>
    <td>status</td>
    <td>VARCHAR(50)</td>
    <td>ç”³è«‹ç‹€æ…‹ (NEW, ACCEPTED, CANCELED)</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>TIMESTAMP</td>
    <td>å»ºç«‹æ™‚é–“</td>
  </tr>
  <tr>
    <td>updated_at</td>
    <td>TIMESTAMP</td>
    <td>æœ€å¾Œæ›´æ–°æ™‚é–“</td>
  </tr>
  </tbody>
</table>

<!-- Delivery Schedules Table -->
<h2>5. `delivery_schedules` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>schedule_id</td>
    <td>æ’ç¨‹å”¯ä¸€è­˜åˆ¥ç¢¼ (Primary Key)</td>
  </tr>
  <tr>
    <td>request_id</td>
    <td>å›æ”¶ç”³è«‹ ID (Foreign Key, ä¾†è‡ª `furniture_requests`)</td>
  </tr>
  <tr>
    <td>vehicle_id</td>
    <td>è»Šè¼› ID (Foreign Key, ä¾†è‡ª `vehicles`)</td>
  </tr>
  <tr>
    <td>eta</td>
    <td>é è¨ˆåˆ°é”æ™‚é–“ï¼ˆETAï¼‰</td>
  </tr>
  <tr>
    <td>status</td>
    <td>æ’ç¨‹ç‹€æ…‹ (å¦‚ PENDING, IN_PROGRESS, COMPLETED ç­‰)</td>
  </tr>
  </tbody>
</table>

<!-- Vehicles Table -->
<h2>6. `vehicles` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>vehicle_id</td>
    <td>è»Šè¼›å”¯ä¸€è­˜åˆ¥ç¢¼ (Primary Key)</td>
  </tr>
  <tr>
    <td>plate_number</td>
    <td>è»Šè¼›è»Šç‰Œè™Ÿç¢¼</td>
  </tr>
  <tr>
    <td>capacity_length</td>
    <td>è»Šè¼›å®¹é‡é•·åº¦</td>
  </tr>
  <tr>
    <td>capacity_width</td>
    <td>è»Šè¼›å®¹é‡å¯¬åº¦</td>
  </tr>
  <tr>
    <td>capacity_height</td>
    <td>è»Šè¼›å®¹é‡é«˜åº¦</td>
  </tr>
  <tr>
    <td>status</td>
    <td>è»Šè¼›ç‹€æ…‹ (å¦‚ AVAILABLE, IN_USE, MAINTENANCE ç­‰)</td>
  </tr>
  </tbody>
</table>

<!-- Reports Table -->
<h2>7. `reports` è¡¨æ ¼</h2>
<table border="1">
  <thead>
  <tr>
    <th>æ¬„ä½åç¨±</th>
    <th>æè¿°</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>report_id</td>
    <td>å ±è¡¨å”¯ä¸€è­˜åˆ¥ç¢¼ (Primary Key)</td>
  </tr>
  <tr>
    <td>report_data</td>
    <td>å ±è¡¨å…§å®¹ï¼ˆé€šå¸¸ç‚º JSON æ ¼å¼ï¼‰</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>å ±è¡¨å‰µå»ºæ™‚é–“</td>
  </tr>
  </tbody>
</table>
</div>
<!-- Mermaid ERD -->
<div id="mermaid-view">
  <div class="mermaid" id="mermaid-graph">
    erDiagram
    %% æ ¸å¿ƒä½¿ç”¨è€…èˆ‡æ¬Šé™
    USERS {
    INT id PK
    VARCHAR username
    VARCHAR password
    VARCHAR email
    BOOLEAN is_manager "ç®¡ç†å“¡/ä¸€èˆ¬ç”¨æˆ¶"
    TIMESTAMP created_at
    TIMESTAMP updated_at
    }

    %% é§•é§›è³‡è¨Š (å› æ’ç¨‹æµç¨‹æåˆ°é§•é§›)
    DRIVERS {
    INT id PK
    VARCHAR name
    VARCHAR phone
    VARCHAR license_number
    VARCHAR status "åœ¨è·/ä¼‘å‡"
    }

    %% å›æ”¶é»åœ°é»è³‡è¨Š (Recycling Points)
    RECYCLING_POINTS {
    INT id PK
    VARCHAR name "ç«™é»åç¨±"
    VARCHAR address "åœ°å€"
    DECIMAL latitude
    DECIMAL longitude
    BOOLEAN is_active "æ˜¯å¦å•Ÿç”¨ (å°æ‡‰ç”¨æˆ¶æµç¨‹çš„'å¯ç”¨')"
    TIMESTAMP created_at
    }

    %% å›æ”¶é»æ™‚æ®µåé¡è¨­å®š (Capacity for specific slots) - è§£æ±ºåé¡éœ€æ±‚
    CAPACITY_SLOTS {
    INT id PK
    INT recycling_point_id FK
    DATE date "ç‰¹å®šæ—¥æœŸ"
    VARCHAR time_slot "ç‰¹å®šæ™‚æ®µ (ex. '9:00-11:00')"
    INT capacity_limit "æ™‚æ®µåé¡ä¸Šé™"
    INT booked_count "å·²é ç´„æ•¸é‡"
    }

    %% é ç´„ä¸»å–® (Service Slots) - ç”¨æˆ¶é ç´„çš„å–®ä¸€æ™‚é–“/åœ°é»
    SERVICE_SLOTS {
    INT id PK
    INT user_id FK
    INT capacity_slot_id FK "é—œè¯åˆ°åé¡è¨­å®š"
    VARCHAR status "ç”³è«‹ç‹€æ…‹ (Pending/Approved/Rejected)"
    TIMESTAMP created_at
    TIMESTAMP updated_at
    VARCHAR admin_notes "ç®¡ç†å“¡å¯©æ ¸å‚™è¨»"
    }

    %% å‚¢ä¿±è³‡æ–™ (Furniture Requests) - é ç´„å–®åº•ä¸‹çš„å¤šä»¶å‚¢ä¿±è³‡è¨Š (å·²æ­£è¦åŒ–)
    FURNITURE_REQUESTS {
    INT id PK
    INT service_slot_id FK "éš¸å±¬æ–¼å“ªå€‹é ç´„å–®"
    VARCHAR name "å‚¢ä¿±åç¨±"
    VARCHAR type "é¡åˆ¥"
    VARCHAR dimensions "å°ºå¯¸"
    VARCHAR material "æè³ª"
    DECIMAL weight "ä¼°è¨ˆé‡é‡"
    VARCHAR photo_url "ç…§ç‰‡é€£çµ (Optional)"
    VARCHAR rejection_reason "é€€ä»¶åŸå›  (å°æ‡‰å¾Œå°æµç¨‹)"
    }

    %% è»Šè¼›è³‡è¨Š (Vehicles) - ç´å…¥ç®¡ç†æµç¨‹æ‰€éœ€çš„æ—¥æœŸè³‡è¨Š
    VEHICLES {
    INT id PK
    VARCHAR plate_number "è»Šç‰Œ"
    DECIMAL capacity_length "è¼‰é‡_é•·"
    DECIMAL capacity_width "è¼‰é‡_å¯¬"
    DECIMAL capacity_height "è¼‰é‡_é«˜"
    VARCHAR status "ç‹€æ…‹ (Active/Disabled)"
    DATE manufacture_date "å‡ºå» æ—¥"
    DATE inspection_date "å®šæª¢æ—¥"
    DATE maintenance_date "ä¿é¤Šæ—¥"
    }

    %% æ´¾è»Šæ’ç¨‹ (Delivery Schedules) - è·¯å¾‘è¦åŠƒçš„æ ¸å¿ƒ
    DELIVERY_SCHEDULES {
    INT id PK
    INT service_slot_id FK "æœ¬æ¬¡æ’ç¨‹æœå‹™çš„é ç´„å–®"
    INT vehicle_id FK
    INT driver_id FK "æœ¬æ¬¡ä»»å‹™æŒ‡æ´¾çš„é§•é§›"
    DATETIME scheduled_pickup_time "é è¨ˆå–ä»¶æ™‚é–“ (ETA)"
    DATETIME actual_pickup_time "å¯¦éš›å–ä»¶æ™‚é–“"
    VARCHAR status "æ’ç¨‹ç‹€æ…‹ (Assigned/On_Route/Completed)"
    }

    %% å ±è¡¨è³‡æ–™ (Reports) - å­˜å„²å ±è¡¨ç”Ÿæˆçš„çµæœæˆ–æ‘˜è¦
    REPORTS {
    INT id PK
    DATETIME start_date
    DATETIME end_date
    VARCHAR report_type "å ±è¡¨é¡å‹ (e.g. æ¡ˆä»¶æ•¸çµ±è¨ˆ/å®Œæˆç‡åˆ†æ)"
    JSON summary_data "çµ±è¨ˆæ‘˜è¦è³‡æ–™ (è€Œéæ‰€æœ‰åŸå§‹è³‡æ–™)"
    BLOB csv_file "å°å‡ºçš„CSVæª”æ¡ˆ"
    TIMESTAMP created_at
    }

    %% é—œè¯é—œä¿‚
    USERS ||--o{ SERVICE_SLOTS : has_made
    RECYCLING_POINTS ||--o{ CAPACITY_SLOTS : defines_capacity
    CAPACITY_SLOTS ||--o{ SERVICE_SLOTS : is_booked_against

    SERVICE_SLOTS ||--o{ FURNITURE_REQUESTS : includes
    SERVICE_SLOTS ||--o{ DELIVERY_SCHEDULES : is_scheduled_for

    VEHICLES ||--o{ DELIVERY_SCHEDULES : is_used_in
    DRIVERS ||--o{ DELIVERY_SCHEDULES : drives_in

    SERVICE_SLOTS ||--o{ REPORTS : summarizes_slot_data
    DELIVERY_SCHEDULES ||--o{ REPORTS : summarizes_delivery_data

  </div>
</div>

<script>
  function showView(view) {
    document.getElementById('table-view').classList.remove('active');
    document.getElementById('mermaid-view').classList.remove('active');

    if (view === 'table') {
      document.getElementById('table-view').classList.add('active');
    } else {
      document.getElementById('mermaid-view').classList.add('active');
      window.renderMermaid();
    }
  }
</script>
</body>
</html>